namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
rename.fasta(infile = file, namechange_nt,
outfile = paste(str_split(file, "\\.", n = 2)[[1]][1], "_renamed.fa", sep = ""))
write.csv(data.frame(new_names_nt, tax_nt$Group, tax_nt$Specie, paste(tax_nt$Group, tax_nt$Specie)),
file = paste(str_split(file, "\\.")[[1]][1], "_tree_names.csv", sep = ""))
#----Nucleotide data----
file <- "nt/nt_raw_seqs.fasta"
write.csv(get.fasta.name(file), file = paste(str_split(file, "\\.")[[1]][1], "_names.csv", sep = ""))
library(seqinr)
library(phylotools)
library(stringr)
write.csv(get.fasta.name(file), file = paste(str_split(file, "\\.")[[1]][1], "_names.csv", sep = ""))
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
accession_nt[i] <- b
}; head(accession_nt)
old_names_nt <- tax_nt$x
file <- "aa/aa_raw_seqs.fasta"
library(seqinr)
library(phylotools)
library(stringr)
write.csv(get.fasta.name(file), "names.csv")
tax <- read.csv("aa/names.csv", row.names = 1); View(tax)
old_names <- tax$x
taxid <- tax$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, ".")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\.")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\.")[[i]][1]
y <- str_split(x, ".")[[i]][1]
y <- str_split(x, ".")[[i]][1]
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, ".")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, ".")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
str_split(x, ".")
x <- str_split(old_names, " ")[[i]][1]
str_split(x, ".")[[i]][1]
str_split(x, "\.")[[i]][1]
x <- str_split(old_names, ".")[[i]][1]
y <- str_split(x, "")
View(y)
i <- 1
x <- str_split(old_names, " ")[[i]][1]
str_split(x, ".")
str_split(x, "\.")
str_split(x, "\\.")
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
View(tax)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[i]][1]
accession_aa[i] <- y
}; head(accession_aa)
y <- str_split(x, "\\.", n = 1)[[i]][1]
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.", n = 1)[[i]][1]
accession_aa[i] <- y
}; head(accession_aa)
y <- str_split(x, "\\.", n = 2)[[i]][1]
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.", n = 2)[[i]][1]
accession_aa[i] <- y
}; head(accession_aa)
y <- strsplit(x, "\\.", n = 2)[[i]][1]
y <- strsplit(x, "\\.")[[i]][1]
accession_aa[i] <- y
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- strsplit(x, "\\.")[[i]][1]
accession_aa[i] <- y
}; head(accession_aa)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- strsplit(x, "\\.")[[i]][1]
accession_aa[i] <- y
}; head(accession_aa)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
accession_aa[i] <- x
}; head(accession_aa)
y <- str_split(x, "\\.")[1]
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[1]
accession_aa[i] <- x
}; head(accession_aa)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[1]
accession_aa[i] <- y
}; head(accession_aa)
y <- str_split(x, "\\.")[[i]][1]
y <- str_split(x, "\\.")[[]][1]
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[]][1]
accession_aa[i] <- y
}; head(accession_aa)
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
View(accession_aa)
accession_aa <- c()
for (i in 1:length(old_names)) {
x <- str_split(old_names, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
namechange_aa <- data.frame(old_names_aa, new_names_aa); head(namechange_aa)
rename.fasta(infile = file, namechange_aa, outfile = "seqs_aa_renamed.fasta")
write.csv(data.frame(new_names, tax$Group, tax$Specie, paste(tax$Group, tax$Specie)),
file = "names_tree.csv")
#----Nucleotide data----
file <- "nt/nt_raw_seqs.fasta"
write.csv(get.fasta.name(file), file = paste(str_split(file, "\\.")[[1]][1], "_names.csv", sep = ""))
tax_nt <- read.csv(paste(str_split(file, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
accession_nt[i] <- b
}; head(accession_nt)
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
rename.fasta(infile = file, namechange_nt,
outfile = paste(str_split(file, "\\.", n = 2)[[1]][1], "_renamed.fa", sep = ""))
library(seqinr)
library(phylotools)
library(stringr)
file <- "aa/aa_raw_seqs.fasta"
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax)
old_names_aa <- tax_aa$x
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
namechange_aa <- data.frame(old_names_aa, new_names_aa); head(namechange_aa)
library(readxl)
db <- read_excel("db_names.xlsx")
View(db)
write.csv(data.frame(new_names, tax$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_bames", sep = ""))
write.csv(data.frame(new_names_aa, tax$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_bames", sep = ""))
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_bames", sep = ""))
file <- "aa/aa_raw_seqs.fasta"
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_bames", sep = ""))
paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_bames", sep = "")
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""))
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = 1)
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = T)
write.csv(data.frame(new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_aa, db$Group, db$Specie, db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group, Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group, Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
new_names_aa
write.csv(data.frame(taxa = sort(new_names_aa, decreasing = F), Group = db$Group, Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
sort(new_names_aa, decreasing = F)
db <- read_excel("db_names.xlsx")
write.csv(data.frame(taxa = sort(new_names_aa, decreasing = F), Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
db <- read_excel("db_names.xlsx")
db <- read_excel("db_names.xlsx"); db
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
#----Nucleotide data----
file <- "nt/nt_raw_seqs.fasta"
tax_nt <- read.csv(paste(str_split(file, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
b
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,  Combined = db$Combined),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
file_aa <- "aa/aa_raw_seqs.fasta"
db <- read_excel("db_names.xlsx"); db
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
namechange_aa <- data.frame(old_names_aa, new_names_aa); head(namechange_aa)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file_aa = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file_aa = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
file <- "aa/aa_raw_seqs.fasta"
file_aa <- "aa/aa_raw_seqs.fasta"
db <- read_excel("db_names.xlsx"); db
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
namechange_aa <- data.frame(old_names_aa, new_names_aa); head(namechange_aa)
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
#----Nucleotide data----
file_nt <- "nt/nt_raw_seqs.fasta"
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,
Combined = db$Combined, TaxID = db$),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie, Combined = db$Combined, TaxID = db$),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""), row.names = F)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,
Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,
Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.txt", sep = ""),
sep = "\t", row.names = F)
file_aa <- "~/Downloads/sequence(1).txt"
write.csv(get.fasta.name(file_aa), file = paste(str_split(file_aa, "\\.")[[1]][1], "_names.csv", sep = ""))
library(seqinr)
library(phylotools)
library(stringr)
library(readxl)
write.csv(get.fasta.name(file_aa), file = paste(str_split(file_aa, "\\.")[[1]][1], "_names.csv", sep = ""))
db <- read_excel("db_names.xlsx"); db
db <- read_excel("~/Downloads/sequence(1)_names.csv"); db
db <- read_excel("~/Downloads/sequence(1)_names.csv"); db
db <- read.csv("~/Downloads/sequence(1)_names.csv", row.names = 1); db
tax_aa <- read.csv("aa/names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
tax_aa <- read.csv("~/Downloads/sequence(1)_names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
#----Nucleotide data----
file_nt <- "~/Downloads/sequence(1).txt"
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
rename.fasta(infile = file_nt, namechange_nt,
outfile = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_renamed.fasta", sep = ""))
#----Nucleotide data----
file_nt <- "~/Downloads/sequence(1).txt"
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
#----Nucleotide data----
file_nt <- "~/Downloads/sequence(1).txt"
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
#----Nucleotide data----
file_nt <- "~/Downloads/sequence(1).txt"
str_split(file_nt, "\\.")[[1]][1]
library(seqinr)
library(phylotools)
library(stringr)
library(readxl)
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,
Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv("~/Downloads/names")
write.csv("~/Downloads/names", namechange_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
write.csv("~/Downloads/names.csv", namechange_nt)
write.csv("~/Downloads/names.csv", namechange_nt, sep = ",")
namechange_nt
write.csv(namechange_nt, "~/Downloads/names.csv")
file_aa <- "aa/aa_raw.fasta"
write.csv(get.fasta.name(file_aa), file = paste(str_split(file_aa, "\\.")[[1]][1], "_names.csv", sep = ""))
library(seqinr)
library(phylotools)
library(stringr)
library(readxl)
write.csv(get.fasta.name(file_aa), file = paste(str_split(file_aa, "\\.")[[1]][1], "_names.csv", sep = ""))
db <- read_excel("db_names.xlsx"); db
db <- read_excel("db_names.xlsx"); db
tax_aa <- read.csv("aa/raw_names.csv", row.names = 1); View(tax_aa)
tax_aa <- read.csv("aa/aa_raw_names.csv", row.names = 1); View(tax_aa)
old_names_aa <- tax_aa$x
taxid_aa <- tax_aa$TaxID
gene <- "rbcL"
accession_aa <- c()
for (i in 1:length(old_names_aa)) {
x <- str_split(old_names_aa, " ")[[i]][1]
y <- str_split(x, "\\.")[[1]][1]
accession_aa[i] <- y
}; head(accession_aa)
new_names_aa <- paste(taxid_aa, accession_aa, gene, sep = "_"); head(new_names_aa)
namechange_aa <- data.frame(old_names_aa, new_names_aa); head(namechange_aa)
rename.fasta(infile = file_aa, namechange_aa,
outfile = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_renamed.fa", sep = ""))
write.csv(data.frame(taxa = new_names_aa, Group = db$Group,
Species = db$Specie,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Order,
Species = db$Species,  Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_aa, Group = db$Order,
Species = db$Species,  Combined = db$Combined, TaxID = db$TaxID),
file = paste(str_split(file_aa, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
#----Nucleotide data----
file_nt <- "nt/nt_raw.fasta"
write.csv(get.fasta.name(file_nt), file = paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""))
tax_nt <- read.csv(paste(str_split(file_nt, "\\.")[[1]][1], "_names.csv", sep = ""),
row.names = 1); View(tax_nt)
old_names_nt <- tax_nt$x
taxid_nt <- tax_nt$TaxID
gene <- "rbcL"
accession_nt <- c()
for (i in 1:length(old_names_nt)) {
a <- str_split(old_names_nt, "protein_id=", n = 2)[[i]][2]; a
b <- str_split(a, "\\]", n = 2)[[1]][1]; b
c <- str_split(b, "\\.", n = 2)[[1]][1]
accession_nt[i] <- c
}; head(accession_nt)
new_names_nt <- paste(taxid_nt, accession_nt, gene, sep = "_"); head(new_names_nt)
namechange_nt <- data.frame(old_names_nt, new_names_nt); head(namechange_nt)
rename.fasta(infile = file_nt, namechange_nt,
outfile = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_renamed.fasta", sep = ""))
write.csv(data.frame(taxa = new_names_nt, Group = db$Group, Species = db$Specie,
Combined = db$Combined, TaxID = db$Taxid),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
write.csv(data.frame(taxa = new_names_nt, Group = db$Order, Species = db$Species,
Combined = db$Combined, TaxID = db$TaxID),
file = paste(str_split(file_nt, "\\.", n = 2)[[1]][1], "_tree_names.csv", sep = ""),
row.names = F)
